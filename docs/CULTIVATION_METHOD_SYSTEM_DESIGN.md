# 完整功法体系设计文档

## 📋 功法体系架构

### 品级分级

| 品级 | 子品级 | 适用境界 | 修炼加成 | 获取途径 | 数量 |
|------|--------|----------|----------|----------|------|
| 人级 | 下品/中品/上品 | 炼气期 | 1.0x-1.2x | 商店购买、新手赠送 | 6种 |
| 黄级 | 下品/中品/上品 | 炼气后期-筑基前期 | 1.3x-1.5x | 商店购买、任务奖励 | 8种 |
| 玄级 | 下品/中品/上品 | 筑基期-金丹前期 | 1.6x-1.8x | 副本掉落、宗门兑换 | 10种 |
| 地级 | 下品/中品/上品 | 金丹期-元婴期 | 1.9x-2.2x | 高级副本、秘境 | 8种 |
| 天级 | 下品/中品/上品 | 元婴后期-化神期 | 2.3x-2.6x | 积分商城兑换 | 6种 |
| 特殊 | 神级 | 不限 | 特殊效果 | 限定活动、原著彩蛋 | 5种 |

**总计**: 43种功法

---

## 🎯 功法类型系统

### 1. 通用型功法
**特点**: 平衡发展，无明显短板
- 修炼速度加成：标准
- 属性加成：全面均衡
- 适合人群：新手、稳健型玩家

### 2. 剑修型功法
**特点**: 高攻击力，剑道专精
- 修炼速度加成：较低
- 属性加成：攻击+30%~50%，灵力+20%
- 灵根要求：通常需要金灵根
- 适合人群：输出向玩家

### 3. 体修型功法
**特点**: 高生命高防御，肉盾角色
- 修炼速度加成：较低
- 属性加成：生命+50%，防御+40%
- 灵根要求：通常需要土灵根
- 适合人群：坦克型玩家

### 4. 法修型功法
**特点**: 高灵力，法术威力强
- 修炼速度加成：中等
- 属性加成：灵力+50%，法术伤害+20%
- 灵根要求：五行灵根均可
- 适合人群：法术流玩家

### 5. 特殊型功法
**特点**: 独特效果，另辟蹊径
- 修炼速度加成：极端
- 属性加成：特殊机制
- 获取方式：限定活动
- 适合人群：收集向、高端玩家

---

## ⚔️ 人级功法（6种）

### 基础入门功法

| 功法名 | 品级 | 类型 | 修炼速度 | 属性加成 | 学习费用 | 需求境界 |
|--------|------|------|----------|----------|----------|----------|
| 长春功 | 人级下品 | 通用 | 1.0x | 无 | 免费 | 炼气期 |
| 铁布衫 | 人级下品 | 体修 | 0.9x | 防御+10, 生命+50 | 500 | 炼气期 |
| 御剑基础 | 人级中品 | 剑修 | 0.95x | 攻击+15 | 1,000 | 炼气期 |
| 五行诀 | 人级中品 | 法修 | 1.0x | 灵力+30 | 1,000 | 炼气期 |
| 金刚功 | 人级上品 | 体修 | 1.0x | 防御+20, 生命+100 | 3,000 | 炼气3层 |
| 玄心诀 | 人级上品 | 通用 | 1.2x | 全属性+5% | 5,000 | 炼气5层 |

---

## 🌟 黄级功法（8种）

### 进阶功法

| 功法名 | 品级 | 类型 | 修炼速度 | 属性加成 | 学习费用 | 需求境界 | 灵根要求 |
|--------|------|------|----------|----------|----------|----------|----------|
| 青木长生诀 | 黄级下品 | 法修 | 1.3x | 灵力+50, 生命恢复+5/回合 | 8,000 | 炼气7层 | 木 |
| 烈火诀 | 黄级下品 | 法修 | 1.3x | 灵力+50, 火属性伤害+10% | 8,000 | 炼气7层 | 火 |
| 厚土诀 | 黄级中品 | 体修 | 1.2x | 防御+35, 生命+200 | 12,000 | 炼气9层 | 土 |
| 疾风诀 | 黄级中品 | 通用 | 1.4x | 速度+20, 闪避+5% | 12,000 | 炼气9层 | 风 |
| 寒冰诀 | 黄级中品 | 法修 | 1.35x | 灵力+60, 水属性伤害+10% | 15,000 | 炼气10层 | 水 |
| 流云剑诀 | 黄级上品 | 剑修 | 1.3x | 攻击+40, 速度+15 | 20,000 | 炼气11层 | 金 |
| 紫霞功 | 黄级上品 | 通用 | 1.5x | 全属性+8% | 25,000 | 炼气12层 | - |
| 北斗七星诀 | 黄级上品 | 法修 | 1.4x | 灵力+80, 法术冷却-10% | 25,000 | 筑基前期 | - |

---

## 💎 玄级功法（10种）

### 中级功法

| 功法名 | 品级 | 类型 | 修炼速度 | 属性加成 | 学习费用 | 需求境界 | 灵根要求 |
|--------|------|------|----------|----------|----------|----------|----------|
| 天罡剑诀 | 玄级下品 | 剑修 | 1.5x | 攻击+60, 暴击+8% | 50,000 | 筑基期 | 金 |
| 不灭金身 | 玄级下品 | 体修 | 1.4x | 防御+50, 生命+400, 伤害减免+5% | 50,000 | 筑基期 | 土 |
| 九天玄雷诀 | 玄级中品 | 法修 | 1.6x | 灵力+120, 雷属性伤害+20% | 80,000 | 筑基中期 | 风+金 |
| 碧海潮生诀 | 玄级中品 | 法修 | 1.6x | 灵力+120, 水属性伤害+20% | 80,000 | 筑基中期 | 水 |
| 赤焰真诀 | 玄级中品 | 法修 | 1.65x | 灵力+130, 火属性伤害+25% | 100,000 | 筑基后期 | 火+土 |
| 太极玄清道 | 玄级上品 | 通用 | 1.8x | 全属性+12%, 修炼顿悟+5% | 120,000 | 筑基后期 | - |
| 飞虹剑诀 | 玄级上品 | 剑修 | 1.7x | 攻击+80, 暴击+12%, 剑气+15% | 150,000 | 金丹前期 | 金 |
| 玄武真功 | 玄级上品 | 体修 | 1.6x | 防御+70, 生命+600, 反伤+5% | 150,000 | 金丹前期 | 水+土 |
| 青莲剑歌 | 玄级上品 | 剑修 | 1.75x | 攻击+85, 速度+30, 连击+10% | 180,000 | 金丹前期 | 木+金 |
| 五行轮转诀 | 玄级上品 | 法修 | 1.8x | 灵力+150, 五行法术+15% | 200,000 | 金丹期 | 五行俱全 |

---

## 🏆 地级功法（8种）

### 高级功法

| 功法名 | 品级 | 类型 | 修炼速度 | 属性加成 | 学习费用 | 需求境界 | 灵根要求 |
|--------|------|------|----------|----------|----------|----------|----------|
| 青元剑诀 | 地级上品 | 剑修 | 1.9x | 攻击+100, 灵力+150, 剑意+20% | 300,000 | 金丹期 | 金 |
| 龙象般若功 | 地级下品 | 体修 | 1.8x | 防御+90, 生命+800, 力量+50 | 250,000 | 金丹期 | - |
| 九转玄功 | 地级中品 | 体修 | 1.9x | 防御+100, 生命+1000, 复活1次/天 | 400,000 | 金丹后期 | - |
| 焚天煮海诀 | 地级中品 | 法修 | 2.0x | 灵力+200, 五行法术+20%, 法术范围+15% | 400,000 | 金丹后期 | - |
| 万剑归宗 | 地级上品 | 剑修 | 2.1x | 攻击+120, 灵力+180, 剑阵+25% | 500,000 | 元婴前期 | 金 |
| 混元功 | 地级上品 | 通用 | 2.2x | 全属性+20%, 突破成功率+10% | 600,000 | 元婴前期 | - |
| 神通变化诀 | 地级上品 | 法修 | 2.1x | 灵力+250, 神通威力+30% | 600,000 | 元婴中期 | - |
| 北冥神功 | 地级上品 | 特殊 | 2.0x | 灵力+300, 吸取他人修为 | 800,000 | 元婴期 | - |

---

## ⭐ 天级功法（6种）

### 顶级功法（积分商城）

| 功法名 | 品级 | 类型 | 修炼速度 | 属性加成 | 积分价格 | 需求境界 | 特殊效果 |
|--------|------|------|----------|----------|----------|----------|----------|
| 大衍诀 | 天级 | 法修 | 2.3x | 灵力+300, 推演天机 | 50,000 | 元婴期 | 可预知危险 |
| 混沌剑经 | 天级下品 | 剑修 | 2.4x | 攻击+150, 灵力+250, 混沌剑意 | 60,000 | 元婴后期 | 无视防御20% |
| 不死不灭功 | 天级中品 | 体修 | 2.3x | 生命+2000, 防御+150, 不死之身 | 70,000 | 元婴后期 | 死亡复活3次/天 |
| 星辰变 | 天级中品 | 通用 | 2.5x | 全属性+30%, 星辰之力 | 80,000 | 化神前期 | 吸收星辰之力 |
| 吞天魔功 | 天级上品 | 特殊 | 2.6x | 灵力+400, 吞噬万物 | 100,000 | 化神期 | 吞噬敌人恢复 |
| 造化金章 | 天级上品 | 通用 | 2.6x | 全属性+35%, 生死造化 | 120,000 | 化神期 | 极速恢复伤势 |

---

## 🌈 特殊功法（5种）

### 原著经典/限定功法

| 功法名 | 品级 | 类型 | 修炼速度 | 属性加成 | 获取方式 | 特殊效果 |
|--------|------|------|----------|----------|----------|----------|
| 青竹玄心诀 | 神级 | 通用 | 3.0x | 全属性+40% | 韩立传承任务 | 辅助炼丹+50% |
| 天星双圣功 | 神级 | 双修 | 2.8x | 双人修炼+100% | 合欢宗秘境 | 双修加速 |
| 大圣真魔功 | 神级 | 魔修 | 2.9x | 攻击+200, 魔性+50% | 魔道传承 | 嗜血狂暴 |
| 梵圣真魔功 | 神级 | 特殊 | 3.0x | 佛魔双修, 全属性+50% | 终极隐藏任务 | 佛魔转换 |
| 时空真解 | 神级 | 法修 | 3.5x | 灵力+500, 时空之力 | 限时活动 | 时间减速 |

---

## 💰 功法价格体系

### 灵石购买（商店）
- 人级：免费 - 5,000 灵石
- 黄级：8,000 - 25,000 灵石
- 玄级：50,000 - 200,000 灵石
- 地级：250,000 - 800,000 灵石

### 积分商城（天级）
- 天级下品：50,000 - 60,000 积分
- 天级中品：70,000 - 80,000 积分
- 天级上品：100,000 - 120,000 积分

### 特殊获取（神级）
- 任务奖励：完成指定剧情任务
- 限时活动：特殊活动期间兑换
- 隐藏彩蛋：发现原著相关秘密

---

## 🎯 功法获取途径

### 1. 商店购买
- **人级全部**（6种）
- **黄级全部**（8种）
- **玄级部分**（前5种）

### 2. 副本掉落
- **玄级中后期**（后5种）
- **地级前期**（前3种）

### 3. 宗门兑换
- **玄级功法**（贡献度兑换）
- **地级部分**（高级贡献度）

### 4. 积分商城兑换
- **天级全部**（6种）
- 每人每种限购1次

### 5. 特殊途径
- **神级功法**（5种）
- 剧情任务、限时活动、隐藏彩蛋

---

## 📊 功法数量统计

| 品级 | 通用 | 剑修 | 体修 | 法修 | 特殊 | 合计 |
|------|------|------|------|------|------|------|
| 人级 | 2 | 1 | 2 | 1 | 0 | 6 |
| 黄级 | 2 | 1 | 1 | 4 | 0 | 8 |
| 玄级 | 1 | 3 | 2 | 4 | 0 | 10 |
| 地级 | 1 | 2 | 2 | 2 | 1 | 8 |
| 天级 | 2 | 1 | 1 | 1 | 1 | 6 |
| 特殊 | 1 | 0 | 0 | 1 | 3 | 5 |
| **总计** | **9** | **8** | **8** | **13** | **5** | **43** |

---

## 🎨 功法命名规范

### 人级功法
- 风格：简单朴实
- 例：长春功、铁布衫、御剑基础

### 黄级功法
- 风格：五行属性为主
- 例：青木长生诀、烈火诀、厚土诀

### 玄级功法
- 风格：天地自然、神话传说
- 例：天罡剑诀、九天玄雷诀、太极玄清道

### 地级功法
- 风格：武侠经典、神通变化
- 例：青元剑诀、九转玄功、万剑归宗

### 天级功法
- 风格：玄幻巅峰、天道法则
- 例：大衍诀、混沌剑经、造化金章

### 特殊功法
- 风格：原著经典、独特机制
- 例：青竹玄心诀、梵圣真魔功、时空真解

---

## 🔧 功法效果机制

### 修炼速度加成
- 影响修为获取速度
- 公式：`基础修为 × 功法加成 × 其他加成`

### 属性加成
- 学习时立即生效
- 切换功法时自动更新
- 包括：攻击、防御、生命、灵力

### 特殊效果
- 战斗中触发的被动效果
- 特殊技能解锁
- 辅助功能（炼丹、炼器等）

---

## 🎓 功法学习机制

### 学习条件
1. **境界要求**：必须达到指定境界
2. **灵根要求**：某些功法需要特定灵根
3. **等级要求**：某些功法需要角色等级
4. **费用支付**：灵石或积分

### 切换功法
- 可以随时切换已学功法
- 切换需支付学习费用
- 属性自动更新（移除旧功法加成，应用新功法加成）

### 功法进阶
- 功法本身不升级
- 通过学习更高品级功法提升
- 旧功法加成自动替换

---

## 💡 平衡性设计

### 修炼速度平衡
- 人级：1.0x - 1.2x（新手友好）
- 黄级：1.3x - 1.5x（平稳过渡）
- 玄级：1.6x - 1.8x（中期主力）
- 地级：1.9x - 2.2x（高端选择）
- 天级：2.3x - 2.6x（顶级追求）
- 特殊：2.8x - 3.5x（终极目标）

### 类型平衡
- **通用型**：修炼快，属性均衡
- **剑修型**：攻击强，修炼慢
- **体修型**：生存高，修炼慢
- **法修型**：灵力高，修炼中等
- **特殊型**：极端属性，独特机制

### 获取难度
- 低级功法：容易获取，灵石购买
- 中级功法：需要探索，副本任务
- 高级功法：积分商城，大量积分
- 特殊功法：极难获取，限定活动

---

## 🚀 实装步骤

### 1. 初始化功法数据
```bash
cd /Users/zc/EC-AI/xiuxian-game
python3 scripts/init_cultivation_methods.py
```

这将创建所有43种功法到数据库中。

### 2. 添加天级功法到积分商城
```bash
python3 scripts/init_credit_shop_cultivation.py
```

这将把6种天级功法添加到积分商城，玩家可以使用积分兑换。

### 3. 测试功法系统
- 使用 `/功法` 命令查看可学习的功法列表
- 使用 `/修炼功法 <功法名>` 学习指定功法
- 使用 `/积分商城` 查看天级功法兑换选项
- 使用 `/我的功法` 查看已学习的功法

---

## 📁 相关文件

### 初始化脚本
- `scripts/init_cultivation_methods.py` - 创建43种功法
- `scripts/init_credit_shop_cultivation.py` - 天级功法加入积分商城

### 模型定义
- `src/bot/models/player.py` - `CultivationMethod` 模型
- `src/bot/models/credit_shop.py` - `CreditShopItem` 模型

### 业务逻辑
- `src/bot/handlers/cultivation_method.py` - 功法相关命令处理
- `src/bot/services/cultivation_service.py` - 修炼服务

### 文档
- `docs/CULTIVATION_METHOD_SYSTEM_DESIGN.md` - 本设计文档

---

**设计完成日期**: 2025-01-25
**实装完成日期**: 2025-01-25
**功法总数**: 43种
**状态**: ✅ 设计完成，✅ 脚本完成，准备运行初始化
