# 符箓系统设计文档 - 凡人修仙传版本

## 📋 系统概述

符箓系统是凡人修仙传中的重要玩法之一。符箓是一次性消耗品，使用后可以释放强大的法术效果，是修士战斗和探险的重要工具。韩立正是靠着大量的金雷竹符箓才能在血色禁地中存活下来。

---

## 🎯 设计理念

### 核心特点
1. **一次性消耗品**：符箓使用后消失，需要持续制作
2. **爆发性威力**：瞬间释放强大效果，适合关键时刻使用
3. **制符技能成长**：通过制作符箓提升制符技能等级
4. **原著符箓还原**：金雷竹符、火球符、冰锥符等经典符箓

### 平衡性原则
- 低级符箓：材料便宜，制作容易，威力一般
- 中级符箓：材料较贵，制作中等，威力强大
- 高级符箓：材料稀有，制作困难，威力惊人

---

## 🔖 符箓分类体系

### 符箓类型

| 类型 | 功能 | 使用场景 | 数量 |
|------|------|---------|------|
| **攻击符** | 直接造成伤害 | 战斗、击杀强敌 | 10种 |
| **防御符** | 提供护盾或减伤 | 防御、保命 | 6种 |
| **治疗符** | 恢复生命 | 疗伤、持续战斗 | 4种 |
| **遁符** | 逃跑、移动 | 逃命、快速赶路 | 4种 |
| **辅助符** | 增益状态 | 提升能力、探测 | 6种 |

**总计**: 30种符箓

### 符箓品阶

| 品阶 | 威力倍率 | 制作成功率 | 制符等级 | 数量 |
|------|---------|-----------|---------|------|
| **下品符箓** | 1.0x - 1.5x | 70-90% | 1-5 | 12种 |
| **中品符箓** | 1.6x - 2.2x | 50-70% | 6-12 | 10种 |
| **上品符箓** | 2.3x - 3.0x | 30-50% | 13-18 | 6种 |
| **极品符箓** | 3.5x - 5.0x | 10-30% | 19+ | 2种 |

---

## ⚡ 攻击符箓（10种）

### 下品攻击符（5种）

#### 1. 火球符
- **品阶**: 下品
- **威力**: 基础攻击×1.2
- **效果**: 发射一个火球攻击敌人
- **材料**: 符纸×1, 朱砂×2, 赤火果粉末×1
- **制符等级**: 1
- **成功率**: 85%
- **灵力消耗**: 20
- **制作时长**: 0.5小时
- **售价**: 500灵石

#### 2. 冰锥符
- **品阶**: 下品
- **威力**: 基础攻击×1.2
- **效果**: 发射冰锥攻击敌人，有几率减速
- **材料**: 符纸×1, 朱砂×2, 寒冰莲粉末×1
- **制符等级**: 1
- **成功率**: 85%
- **灵力消耗**: 20
- **制作时长**: 0.5小时
- **售价**: 500灵石

#### 3. 金刃符
- **品阶**: 下品
- **威力**: 基础攻击×1.3
- **效果**: 召唤金属刃片攻击
- **材料**: 符纸×1, 朱砂×3, 金线藤粉末×1
- **制符等级**: 2
- **成功率**: 80%
- **灵力消耗**: 25
- **制作时长**: 1小时
- **售价**: 800灵石

#### 4. 藤蔓缠绕符
- **品阶**: 下品
- **威力**: 基础攻击×0.8
- **效果**: 召唤藤蔓缠绕敌人，造成伤害并束缚1回合
- **材料**: 符纸×1, 朱砂×2, 青灵草粉末×2
- **制符等级**: 2
- **成功率**: 80%
- **灵力消耗**: 25
- **制作时长**: 1小时
- **售价**: 800灵石

#### 5. 雷击符
- **品阶**: 下品
- **威力**: 基础攻击×1.5
- **效果**: 召唤雷电攻击敌人
- **材料**: 符纸×1, 朱砂×3, 紫云芝粉末×2
- **制符等级**: 3
- **成功率**: 75%
- **灵力消耗**: 30
- **制作时长**: 1小时
- **售价**: 1200灵石

### 中品攻击符（3种）

#### 6. 金雷竹符
- **品阶**: 中品
- **威力**: 基础攻击×2.0
- **效果**: 金雷交织，强大的雷电攻击（韩立常用）
- **材料**: 黄符纸×1, 精制朱砂×3, 金雷竹粉末×1
- **制符等级**: 8
- **成功率**: 60%
- **灵力消耗**: 80
- **制作时长**: 3小时
- **售价**: 10000灵石

#### 7. 烈焰符
- **品阶**: 中品
- **威力**: 基础攻击×1.8
- **效果**: 释放大面积火焰，范围攻击
- **材料**: 黄符纸×1, 精制朱砂×3, 赤火果×1
- **制符等级**: 7
- **成功率**: 65%
- **灵力消耗**: 70
- **制作时长**: 2.5小时
- **售价**: 8000灵石

#### 8. 寒冰爆符
- **品阶**: 中品
- **威力**: 基础攻击×1.9
- **效果**: 冰霜爆炸，冻结敌人2回合
- **材料**: 黄符纸×1, 精制朱砂×3, 寒冰莲×2
- **制符等级**: 8
- **成功率**: 60%
- **灵力消耗**: 80
- **制作时长**: 3小时
- **售价**: 9000灵石

### 上品攻击符（2种）

#### 9. 五雷符
- **品阶**: 上品
- **威力**: 基础攻击×2.8
- **效果**: 召唤五道雷电连续攻击
- **材料**: 玉符纸×1, 天雷沙×2, 龙血草粉末×1
- **制符等级**: 15
- **成功率**: 40%
- **灵力消耗**: 150
- **制作时长**: 8小时
- **售价**: 50000灵石

#### 10. 剑气符
- **品阶**: 上品
- **威力**: 基础攻击×3.0
- **效果**: 凝聚剑气斩击，无视30%防御
- **材料**: 玉符纸×1, 天雷沙×2, 金刚果粉末×2
- **制符等级**: 16
- **成功率**: 35%
- **灵力消耗**: 160
- **制作时长**: 10小时
- **售价**: 60000灵石

---

## 🛡️ 防御符箓（6种）

### 下品防御符（3种）

#### 11. 金光符
- **品阶**: 下品
- **威力**: 防御+50
- **效果**: 形成金色护盾，持续3回合
- **材料**: 符纸×1, 朱砂×2, 金线藤粉末×1
- **制符等级**: 2
- **成功率**: 80%
- **灵力消耗**: 25
- **制作时长**: 1小时
- **售价**: 600灵石

#### 12. 土墙符
- **品阶**: 下品
- **威力**: 防御+60
- **效果**: 召唤土墙阻挡攻击，持续2回合
- **材料**: 符纸×1, 朱砂×2, 青灵草粉末×2
- **制符等级**: 2
- **成功率**: 80%
- **灵力消耗**: 25
- **制作时长**: 1小时
- **售价**: 600灵石

#### 13. 护体符
- **品阶**: 下品
- **威力**: 伤害减免20%
- **效果**: 全身护罩，持续5回合
- **材料**: 符纸×1, 朱砂×3, 金刚果粉末×1
- **制符等级**: 3
- **成功率**: 75%
- **灵力消耗**: 30
- **制作时长**: 1小时
- **售价**: 1000灵石

### 中品防御符（2种）

#### 14. 金刚符
- **品阶**: 中品
- **威力**: 防御+150
- **效果**: 金刚护体，持续10回合
- **材料**: 黄符纸×1, 精制朱砂×3, 金刚果×2
- **制符等级**: 9
- **成功率**: 55%
- **灵力消耗**: 90
- **制作时长**: 3小时
- **售价**: 12000灵石

#### 15. 玄冰盾符
- **品阶**: 中品
- **威力**: 吸收3000点伤害
- **效果**: 冰盾护体，直到破碎
- **材料**: 黄符纸×1, 精制朱砂×3, 寒冰莲×2, 玉随芝粉末×1
- **制符等级**: 10
- **成功率**: 50%
- **灵力消耗**: 100
- **制作时长**: 4小时
- **售价**: 15000灵石

### 上品防御符（1种）

#### 16. 金刚不坏符
- **品阶**: 上品
- **威力**: 伤害减免50%
- **效果**: 金刚不坏，持续1分钟，免疫控制
- **材料**: 玉符纸×1, 天雷沙×2, 紫髓晶粉末×1
- **制符等级**: 17
- **成功率**: 30%
- **灵力消耗**: 180
- **制作时长**: 12小时
- **售价**: 80000灵石

---

## 💚 治疗符箓（4种）

### 下品治疗符（2种）

#### 17. 回春符
- **品阶**: 下品
- **威力**: 恢复500生命
- **效果**: 瞬间恢复生命值
- **材料**: 符纸×1, 朱砂×2, 青灵草粉末×2
- **制符等级**: 1
- **成功率**: 85%
- **灵力消耗**: 20
- **制作时长**: 0.5小时
- **售价**: 500灵石

#### 18. 聚灵符
- **品阶**: 下品
- **威力**: 恢复300灵力
- **效果**: 瞬间恢复灵力值
- **材料**: 符纸×1, 朱砂×2, 碧心花粉末×2
- **制符等级**: 1
- **成功率**: 85%
- **灵力消耗**: 20
- **制作时长**: 0.5小时
- **售价**: 500灵石

### 中品治疗符（1种）

#### 19. 大回春符
- **品阶**: 中品
- **威力**: 恢复2000生命
- **效果**: 大幅恢复生命值
- **材料**: 黄符纸×1, 精制朱砂×3, 玉随芝粉末×1
- **制符等级**: 8
- **成功率**: 60%
- **灵力消耗**: 80
- **制作时长**: 3小时
- **售价**: 10000灵石

### 上品治疗符（1种）

#### 20. 续命符
- **品阶**: 上品
- **威力**: 恢复50%生命+灵力
- **效果**: 濒死时自动触发，救命符箓
- **材料**: 玉符纸×1, 天雷沙×2, 龙血草粉末×1, 紫髓晶粉末×1
- **制符等级**: 18
- **成功率**: 25%
- **灵力消耗**: 200
- **制作时长**: 15小时
- **售价**: 100000灵石

---

## 🌀 遁符（4种）

### 下品遁符（2种）

#### 21. 轻身符
- **品阶**: 下品
- **威力**: 速度+50%
- **效果**: 短时间加快移动速度，持续10分钟
- **材料**: 符纸×1, 朱砂×2, 金线藤粉末×1
- **制符等级**: 2
- **成功率**: 80%
- **灵力消耗**: 25
- **制作时长**: 1小时
- **售价**: 600灵石

#### 22. 遁地符
- **品阶**: 下品
- **威力**: 逃跑成功率+30%
- **效果**: 遁入地下短距离移动
- **材料**: 符纸×1, 朱砂×3, 青灵草粉末×2
- **制符等级**: 3
- **成功率**: 75%
- **灵力消耗**: 30
- **制作时长**: 1小时
- **售价**: 1000灵石

### 中品遁符（1种）

#### 23. 五行遁符
- **品阶**: 中品
- **威力**: 瞬间移动100米
- **效果**: 选择金木水火土一种进行短距离瞬移
- **材料**: 黄符纸×1, 精制朱砂×5, 五行灵粉×1
- **制符等级**: 12
- **成功率**: 45%
- **灵力消耗**: 120
- **制作时长**: 6小时
- **售价**: 25000灵石

### 极品遁符（1种）

#### 24. 血影遁符
- **品阶**: 极品
- **威力**: 瞬移1000米
- **效果**: 韩立绝技，消耗气血强行瞬移
- **材料**: 仙符纸×1, 天雷沙×5, 血参精粉末×1
- **制符等级**: 20
- **成功率**: 15%
- **灵力消耗**: 300
- **制作时长**: 24小时
- **售价**: 200000灵石

---

## ✨ 辅助符箓（6种）

### 下品辅助符（3种）

#### 25. 探灵符
- **品阶**: 下品
- **威力**: 探测范围100米
- **效果**: 探测周围灵气和妖兽
- **材料**: 符纸×1, 朱砂×2, 碧心花粉末×1
- **制符等级**: 1
- **成功率**: 85%
- **灵力消耗**: 20
- **制作时长**: 0.5小时
- **售价**: 500灵石

#### 26. 隐身符
- **品阶**: 下品
- **威力**: 隐身10分钟
- **效果**: 隐匿身形，避开低级妖兽
- **材料**: 符纸×1, 朱砂×3, 九幽草粉末×1
- **制符等级**: 3
- **成功率**: 75%
- **灵力消耗**: 30
- **制作时长**: 1小时
- **售价**: 1200灵石

#### 27. 破禁符
- **品阶**: 下品
- **威力**: 破解低级禁制
- **效果**: 破解炼气期禁制阵法
- **材料**: 符纸×1, 朱砂×3, 紫云芝粉末×2
- **制符等级**: 4
- **成功率**: 70%
- **灵力消耗**: 35
- **制作时长**: 1.5小时
- **售价**: 1500灵石

### 中品辅助符（2种）

#### 28. 神识增幅符
- **品阶**: 中品
- **威力**: 神识+100%
- **效果**: 短时间大幅增强神识，持续1小时
- **材料**: 黄符纸×1, 精制朱砂×4, 星月露×1
- **制符等级**: 10
- **成功率**: 50%
- **灵力消耗**: 100
- **制作时长**: 4小时
- **售价**: 15000灵石

#### 29. 破阵符
- **品阶**: 中品
- **威力**: 破解中级阵法
- **效果**: 强行破解筑基期阵法
- **材料**: 黄符纸×1, 精制朱砂×4, 天灵果粉末×1
- **制符等级**: 11
- **成功率**: 45%
- **灵力消耗**: 110
- **制作时长**: 5小时
- **售价**: 20000灵石

### 极品辅助符（1种）

#### 30. 锁空符
- **品阶**: 极品
- **威力**: 封锁空间
- **效果**: 短暂封锁周围空间，禁止瞬移和传送
- **材料**: 仙符纸×1, 天雷沙×5, 化神花粉末×1
- **制符等级**: 22
- **成功率**: 10%
- **灵力消耗**: 400
- **制作时长**: 30小时
- **售价**: 500000灵石

---

## 📜 符箓材料体系

### 基础材料

#### 1. 符纸类
- **白符纸** - 基础符纸，用于下品符箓（10灵石/张）
- **黄符纸** - 中级符纸，用于中品符箓（100灵石/张）
- **玉符纸** - 高级符纸，用于上品符箓（1000灵石/张）
- **仙符纸** - 顶级符纸，用于极品符箓（10000灵石/张）

#### 2. 墨料类
- **朱砂** - 基础符墨（5灵石/份）
- **精制朱砂** - 精制符墨（50灵石/份）
- **天雷沙** - 高级符墨（500灵石/份）

#### 3. 特殊材料
- **金雷竹粉末** - 金雷竹磨成的粉末（5000灵石/份）
- **五行灵粉** - 五行精华混合（2000灵石/份）
- **各类灵药粉末** - 灵药研磨成粉（价格等于灵药的50%）

### 材料获取
- 符纸、朱砂：商店购买
- 灵药粉末：将持有的灵药研磨（需要研磨工具）
- 特殊材料：高级商店、副本掉落

---

## 🎓 制符技能系统

### 技能等级划分

| 等级 | 称号 | 经验要求 | 可制作品阶 | 成功率加成 |
|------|------|---------|-----------|-----------|
| 1-5 | 制符学徒 | 0 - 5000 | 下品 | +0% |
| 6-12 | 制符师 | 5000 - 30000 | 下品、中品 | +5% |
| 13-18 | 高级制符师 | 30000 - 150000 | 下品、中品、上品 | +10% |
| 19-22 | 制符宗师 | 150000 - 500000 | 全部 | +15% |
| 23+ | 符道仙人 | 500000+ | 全部 | +20% |

### 经验获取

**制作成功**：
- 下品符箓：20-60 经验
- 中品符箓：80-200 经验
- 上品符箓：300-600 经验
- 极品符箓：800-1500 经验

**制作失败**：获得30%经验

---

## ⚙️ 制符机制

### 成功率计算
```
最终成功率 = 基础成功率 × (1 + 制符等级加成) × (1 + 灵根加成)
最大不超过95%
```

### 灵根加成
- **单属性灵根**：对应属性符箓+5%
- **双属性灵根**：对应属性符箓+3%

### 品质系统
- 制作成功后，符箓品质0-100
- 品质影响符箓威力：威力 × (1 + 品质/200)
- 大成功（5%几率）：品质+20

---

## 💰 经济系统

### 制作成本

- **下品符箓**：500-1,500灵石
- **中品符箓**：8,000-25,000灵石
- **上品符箓**：50,000-100,000灵石
- **极品符箓**：200,000-500,000灵石

### 市场价值

成功制作的符箓可以:
1. 自用（战斗、探索）
2. 出售获利（售价为成本的150-250%）
3. 交易给其他玩家
4. 宗门贡献

---

## 📊 数据总览

### 符箓统计

| 品阶 | 数量 | 基础成功率 | 平均材料成本 | 平均制作时长 |
|------|------|-----------|-------------|-------------|
| 下品 | 12 | 75-85% | 500-1,500 | 0.5-1.5小时 |
| 中品 | 10 | 45-65% | 8,000-25,000 | 2.5-6小时 |
| 上品 | 6 | 25-40% | 50,000-100,000 | 8-15小时 |
| 极品 | 2 | 10-15% | 200,000-500,000 | 24-30小时 |
| **总计** | **30** | - | - | - |

### 类型统计

- 攻击符：10种（33%）
- 防御符：6种（20%）
- 治疗符：4种（13%）
- 遁符：4种（13%）
- 辅助符：6种（21%）

---

## 🚀 实装步骤

### 1. 创建符箓材料
- 4种符纸（白/黄/玉/仙）
- 3种墨料（朱砂/精制朱砂/天雷沙）
- 3种特殊材料（金雷竹粉末、五行灵粉、灵药粉末说明）

### 2. 创建符箓配方
运行 `scripts/init_talisman_system.py`:
- 创建30条符箓配方记录
- 关联材料和效果
- 设置制作参数

### 3. 测试验证
- 测试各品阶符箓配方
- 验证材料关联
- 检查数值平衡

---

## 📁 相关文件

### 数据模型
- `src/bot/models/talisman.py` - 符箓系统模型（已存在）

### 初始化脚本
- `scripts/init_talisman_system.py` - 符箓系统初始化脚本（待创建）

### 业务逻辑
- `src/bot/handlers/talisman.py` - 符箓命令处理器（已存在）

### 文档
- `docs/TALISMAN_SYSTEM_DESIGN.md` - 本设计文档

---

## 📝 开发笔记

### 设计考量

1. **一次性消耗**：符箓使用后消失，鼓励玩家持续制作
2. **爆发威力**：关键时刻可以改变战局
3. **原著还原**：金雷竹符、血影遁等经典符箓
4. **经济循环**：制符需要大量材料，消耗灵石

### 未来扩展

- 符宝系统（高级一次性法宝）
- 组合符箓（多个符箓组合使用）
- 符阵系统（符箓布阵）
- 特殊符箓（限定活动获取）

---

**设计完成日期**: 2025-01-25
**状态**: ✅ 设计完成，准备实装
**总符箓数**: 30种
**总材料数**: 10种基础材料
