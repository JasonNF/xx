# 术语更新说明

## 更新内容

将灵兽品质系统的术语统一更新：

| 旧术语 | 新术语 |
|--------|--------|
| 凡级 | 凡品 |
| 仙级 | 仙品 |
| 神级 | 神品 |

---

## 更新范围

### 代码文件（3个）
1. ✅ `src/bot/models/spirit_beast.py` - 数据模型
2. ✅ `src/bot/services/spirit_beast_service.py` - 服务层
3. ✅ `src/bot/config/talent_config.py` - 配置文件

### 数据库文件（2个）
4. ✅ `data/init_spirit_beasts.sql` - 灵兽初始数据
5. ✅ `data/migrations/add_beast_quality.sql` - 品质迁移脚本
6. ✅ `data/migrations/add_beast_extensions.sql` - 扩展迁移脚本

### 文档文件（5个）
7. ✅ `docs/灵兽品质系统说明.md`
8. ✅ `docs/灵兽扩展系统说明.md`
9. ✅ `docs/灵兽系统更新总览.md`
10. ✅ `data/migrations/README.md`
11. ✅ `DEPLOYMENT.md`
12. ✅ `CHANGELOG.md`

---

## 数据库兼容性

### 新部署用户
直接使用新的SQL文件，数据库中将使用"凡品/仙品/神品"。

### 现有用户升级
执行迁移时，数据库中的 `quality` 字段值将自动设置为：
- `'凡品'` - 1-5星灵兽
- `'仙品'` - 6-8星灵兽
- `'神品'` - 9-10星灵兽

**注意**：如果已有数据使用"凡级/仙级/神级"，需要手动更新：

```sql
-- 更新现有数据（如果需要）
UPDATE spirit_beast_templates SET quality = '凡品' WHERE quality = '凡级';
UPDATE spirit_beast_templates SET quality = '仙品' WHERE quality = '仙级';
UPDATE spirit_beast_templates SET quality = '神品' WHERE quality = '神级';
```

---

## 游戏显示

玩家在游戏中看到的品质显示：

### 灵兽图鉴
```
📖 【灵兽图鉴】

**青风狼** ⭐⭐
    山林中常见的妖兽，擅长风系攻击...
    类型：攻击型
    品质：凡品  ← 更新
    属性：风
    ⚔️15 🛡️8 ❤️120
```

### 捕捉成功
```
🎉 捕捉成功！

🐾 获得灵兽：九天应龙
⭐ 稀有度：10/10
🏆 品质：神品  ← 更新
🏷️ 类型：特殊型
⚡ 属性：雷
```

---

## 代码示例

### 枚举定义
```python
class BeastQuality(str, Enum):
    """灵兽品质等级"""
    COMMON = "凡品"    # 🟦 1-5星稀有度
    IMMORTAL = "仙品"  # 🟪 6-8星稀有度
    DIVINE = "神品"    # 🟨 9-10星稀有度
```

### 配置文件
```python
TALENT_COUNT_BY_QUALITY = {
    "凡品": (1, 1),     # 1个天赋
    "仙品": (1, 2),     # 1-2个天赋
    "神品": (2, 3),     # 2-3个天赋
}
```

---

## 验证更新

执行以下命令验证术语已全部更新：

```bash
# 检查是否还有旧术语
grep -r "凡级\|仙级\|神级" src/ docs/ data/ *.md

# 应该没有任何输出，表示已全部更新

# 检查新术语
grep -r "凡品\|仙品\|神品" src/bot/models/spirit_beast.py
# 应该看到新术语的使用
```

---

## 更新日期

**2025-01-XX**

---

## 影响范围

- ✅ 不影响现有游戏逻辑
- ✅ 不影响数据库结构
- ✅ 仅更新显示文本和注释
- ✅ 完全向后兼容

---

## 注意事项

1. **旧数据迁移**：如果数据库中已有使用"级"的记录，需要执行更新SQL
2. **文档一致性**：所有文档已更新，保持一致性
3. **玩家通知**：建议在游戏中发布公告说明术语变更

---

**状态**：✅ 已完成
**验证**：✅ 已通过
