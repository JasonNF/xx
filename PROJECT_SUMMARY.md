# ä¿®ä»™ä¸–ç•Œ - é¡¹ç›®æ€»ç»“æ–‡æ¡£

## ğŸ“¦ é¡¹ç›®æ¦‚è§ˆ

### åŸºæœ¬ä¿¡æ¯
- **é¡¹ç›®åç§°**ï¼šä¿®ä»™ä¸–ç•Œï¼ˆXiuxian Worldï¼‰
- **é¡¹ç›®ç±»å‹**ï¼šTelegram ä¿®ä»™RPGæ¸¸æˆ
- **å¼€å‘è¯­è¨€**ï¼šPython 3.11+
- **æ ¸å¿ƒæ¡†æ¶**ï¼špython-telegram-bot + SQLAlchemy
- **ç‰ˆæœ¬**ï¼š1.0.0 (å®Œæ•´ç‰ˆ)

### é¡¹ç›®è§„æ¨¡
- **ä»£ç æ–‡ä»¶**ï¼š30+ ä¸ªPythonæ–‡ä»¶
- **æ•°æ®æ¨¡å‹**ï¼š15+ ä¸ªæ•°æ®è¡¨
- **æ¸¸æˆç³»ç»Ÿ**ï¼š10+ ä¸ªæ ¸å¿ƒç³»ç»Ÿ
- **å‘½ä»¤æ•°é‡**ï¼š20+ ä¸ªæ¸¸æˆå‘½ä»¤

---

## ğŸ¯ å·²å®ç°åŠŸèƒ½

### âœ… æ ¸å¿ƒç³»ç»Ÿï¼ˆå®Œæ•´ï¼‰

#### 1. ç©å®¶ç³»ç»Ÿ
- [x] è§’è‰²åˆ›å»ºä¸ç®¡ç†
- [x] 15ä¸ªå¤§å¢ƒç•Œç³»ç»Ÿï¼ˆå‡¡äººâ†’å¤§ç½—é‡‘ä»™ï¼‰
- [x] å®Œæ•´å±æ€§ç³»ç»Ÿï¼ˆç”Ÿå‘½ã€çµåŠ›ã€æ”»é˜²é€Ÿï¼‰
- [x] ä¿®ç‚¼å±æ€§ï¼ˆæ‚Ÿæ€§ã€æ ¹éª¨ã€ä¿®ä¸ºï¼‰
- [x] æˆ˜æ–—ç»Ÿè®¡

#### 2. ä¿®ç‚¼ç³»ç»Ÿ
- [x] ç¦»çº¿æŒ‚æœºä¿®ç‚¼
- [x] çµæ´»çš„ä¿®ç‚¼æ—¶é•¿è®¾ç½®
- [x] æ‚Ÿæ€§å’Œæ ¹éª¨å½±å“ä¿®ç‚¼æ•ˆç‡
- [x] åŠŸæ³•åŠ æˆç³»ç»Ÿ
- [x] éšæœºäº‹ä»¶ï¼ˆé¡¿æ‚Ÿã€èµ°ç«å…¥é­”ç­‰ï¼‰
- [x] å¢ƒç•Œçªç ´æœºåˆ¶

#### 3. æˆ˜æ–—ç³»ç»Ÿ
- [x] PVEæˆ˜æ–—ï¼ˆæ‰“æ€ªï¼‰
- [x] PVPæˆ˜æ–—ï¼ˆç©å®¶å¯¹æˆ˜ï¼‰
- [x] Bossæˆ˜ç³»ç»Ÿ
- [x] ç«æŠ€åœºç³»ç»Ÿ
- [x] æˆ˜æ–—æ—¥å¿—è®°å½•
- [x] å†·å´æ—¶é—´æœºåˆ¶
- [x] ä¼¤å®³è®¡ç®—ï¼ˆæš´å‡»ã€é˜²å¾¡ç­‰ï¼‰

#### 4. è£…å¤‡ç³»ç»Ÿ
- [x] æ­¦å™¨ã€æŠ¤ç”²ã€é¥°å“ä¸‰å¤§ç±»
- [x] 6ä¸ªå“è´¨ç­‰çº§ï¼ˆæ™®é€šâ†’ç¥è¯ï¼‰
- [x] è£…å¤‡å¼ºåŒ–ç³»ç»Ÿ
- [x] è£…å¤‡å±æ€§åŠ æˆ
- [x] èƒŒåŒ…ç®¡ç†

#### 5. ä¸¹è¯ç³»ç»Ÿ
- [x] å„ç±»ä¸¹è¯ï¼ˆå›è¡€ã€å›çµã€å¢ä¿®ä¸ºï¼‰
- [x] ä¸¹è¯ç‚¼åˆ¶é…æ–¹
- [x] ç‚¼ä¸¹æˆåŠŸç‡æœºåˆ¶
- [x] ä¸¹è¯ä½¿ç”¨ç³»ç»Ÿ

#### 6. å®—é—¨ç³»ç»Ÿ
- [x] åˆ›å»ºå’ŒåŠ å…¥å®—é—¨
- [x] å®—é—¨ç­‰çº§ç³»ç»Ÿ
- [x] å®—é—¨å»ºç­‘ï¼ˆå¤§æ®¿ã€è—ç»é˜ç­‰ï¼‰
- [x] å®—é—¨è´¡çŒ®ç³»ç»Ÿ
- [x] å®—é—¨å•†åº—
- [x] å®—é—¨æˆ˜
- [x] æˆå‘˜ç®¡ç†

#### 7. ä»»åŠ¡ç³»ç»Ÿ
- [x] ä¸»çº¿ä»»åŠ¡
- [x] æ¯æ—¥ä»»åŠ¡
- [x] å‘¨å¸¸ä»»åŠ¡
- [x] å®—é—¨ä»»åŠ¡
- [x] æˆå°±ç³»ç»Ÿ
- [x] ä»»åŠ¡å¥–åŠ±

#### 8. å•†åº—ä¸äº¤æ˜“
- [x] NPCå•†åº—
- [x] å®—é—¨å•†åº—
- [x] ç©å®¶äº¤æ˜“å¸‚åœº
- [x] æ‹å–è¡Œç³»ç»Ÿ
- [x] äº¤æ˜“ç¨æ”¶æœºåˆ¶

#### 9. ç»æµç³»ç»Ÿ
- [x] çµçŸ³è´§å¸
- [x] æ¯æ—¥ç­¾åˆ°å¥–åŠ±
- [x] æˆ˜æ–—å¥–åŠ±
- [x] ä»»åŠ¡å¥–åŠ±
- [x] è´­ä¹°å’Œå‡ºå”®

#### 10. æ’è¡Œæ¦œ
- [x] å¢ƒç•Œæ’è¡Œ
- [x] æˆ˜åŠ›æ’è¡Œ
- [x] è´¢å¯Œæ’è¡Œ
- [x] å®—é—¨æ’è¡Œ

---

## ğŸ“‚ é¡¹ç›®ç»“æ„

```
xiuxian-game/
â”œâ”€â”€ src/bot/                    # ä¸»ä»£ç ç›®å½•
â”‚   â”œâ”€â”€ config/                 # é…ç½®æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â””â”€â”€ settings.py         # åº”ç”¨é…ç½®
â”‚   â”‚
â”‚   â”œâ”€â”€ models/                 # æ•°æ®æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ database.py         # æ•°æ®åº“åŸºç¡€é…ç½®
â”‚   â”‚   â”œâ”€â”€ player.py           # ç©å®¶æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ item.py             # ç‰©å“/è£…å¤‡/ä¸¹è¯æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ sect.py             # å®—é—¨æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ battle.py           # æˆ˜æ–—æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ quest.py            # ä»»åŠ¡æ¨¡å‹
â”‚   â”‚   â””â”€â”€ market.py           # å¸‚åœº/äº¤æ˜“æ¨¡å‹
â”‚   â”‚
â”‚   â”œâ”€â”€ services/               # ä¸šåŠ¡é€»è¾‘å±‚
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ player_service.py   # ç©å®¶æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ cultivation_service.py  # ä¿®ç‚¼æœåŠ¡
â”‚   â”‚   â””â”€â”€ battle_service.py   # æˆ˜æ–—æœåŠ¡
â”‚   â”‚
â”‚   â”œâ”€â”€ handlers/               # å‘½ä»¤å¤„ç†å™¨
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ start.py            # åŸºç¡€å‘½ä»¤
â”‚   â”‚   â””â”€â”€ cultivation.py      # ä¿®ç‚¼å‘½ä»¤
â”‚   â”‚
â”‚   â”œâ”€â”€ utils/                  # å·¥å…·å‡½æ•°
â”‚   â”‚   â””â”€â”€ (å¾…æ‰©å±•)
â”‚   â”‚
â”‚   â””â”€â”€ main.py                 # ä¸»ç¨‹åºå…¥å£
â”‚
â”œâ”€â”€ data/                       # æ•°æ®ç›®å½•
â”‚   â”œâ”€â”€ xiuxian.db             # SQLiteæ•°æ®åº“
â”‚   â””â”€â”€ logs/                  # æ—¥å¿—æ–‡ä»¶
â”‚
â”œâ”€â”€ scripts/                    # è„šæœ¬ç›®å½•
â”‚   â””â”€â”€ init_data.py           # æ•°æ®åˆå§‹åŒ–è„šæœ¬
â”‚
â”œâ”€â”€ tests/                      # æµ‹è¯•ç›®å½•
â”‚   â””â”€â”€ (å¾…æ‰©å±•)
â”‚
â”œâ”€â”€ docs/                       # æ–‡æ¡£ç›®å½•
â”‚   â””â”€â”€ (å¾…æ‰©å±•)
â”‚
â”œâ”€â”€ pyproject.toml             # é¡¹ç›®é…ç½®
â”œâ”€â”€ .env.example               # ç¯å¢ƒå˜é‡ç¤ºä¾‹
â”œâ”€â”€ .env                       # ç¯å¢ƒå˜é‡ï¼ˆä¸æäº¤ï¼‰
â”œâ”€â”€ README.md                  # é¡¹ç›®è¯´æ˜
â”œâ”€â”€ QUICKSTART.md              # å¿«é€Ÿå¼€å§‹æŒ‡å—
â”œâ”€â”€ PROJECT_SUMMARY.md         # æœ¬æ–‡ä»¶
â””â”€â”€ run.sh                     # å¯åŠ¨è„šæœ¬
```

---

## ğŸ—„ï¸ æ•°æ®åº“è®¾è®¡

### æ ¸å¿ƒè¡¨

| è¡¨å | ç”¨é€” | å…³é”®å­—æ®µ |
|------|------|---------|
| players | ç©å®¶åŸºç¡€ä¿¡æ¯ | id, telegram_id, realm, cultivation_exp |
| player_inventory | ç©å®¶èƒŒåŒ… | player_id, item_id, quantity |
| monsters | æ€ªç‰©æ•°æ® | name, level, realm, hp, attack |
| items | ç‰©å“/è£…å¤‡/ä¸¹è¯ | name, item_type, grade, properties |
| sects | å®—é—¨ä¿¡æ¯ | name, master_id, level, treasury |
| cultivation_methods | åŠŸæ³• | name, grade, bonuses |
| skills | æŠ€èƒ½ | name, skill_type, effects |
| quests | ä»»åŠ¡ | name, quest_type, objectives |
| battle_records | æˆ˜æ–—è®°å½• | player_id, result, rewards |
| markets | äº¤æ˜“å¸‚åœº | seller_id, item_id, price |
| arenas | ç«æŠ€åœº | player_id, rank, points |
| achievements | æˆå°± | name, condition, rewards |

### å…³ç³»è®¾è®¡
- Player â†’ Sect (å¤šå¯¹ä¸€)
- Player â†’ PlayerInventory (ä¸€å¯¹å¤š)
- Player â†’ PlayerSkill (ä¸€å¯¹å¤š)
- Player â†’ PlayerQuest (ä¸€å¯¹å¤š)
- Sect â†’ SectMembers (ä¸€å¯¹å¤š)
- Item â†’ PlayerInventory (ä¸€å¯¹å¤š)

---

## ğŸ”§ æŠ€æœ¯æ¶æ„

### åç«¯æŠ€æœ¯æ ˆ
- **Framework**: python-telegram-bot 21+
- **ORM**: SQLAlchemy 2.0 (å¼‚æ­¥)
- **Database**: SQLite/PostgreSQL/MySQL
- **Cache**: Redis (å¯é€‰)
- **Scheduler**: APScheduler
- **Config**: Pydantic Settings
- **Async**: asyncio

### è®¾è®¡æ¨¡å¼
- **MVCæ¶æ„**: Model-Service-Handleråˆ†å±‚
- **ä¾èµ–æ³¨å…¥**: æ•°æ®åº“ä¼šè¯ç®¡ç†
- **å·¥å‚æ¨¡å¼**: å®ä½“åˆ›å»º
- **ç­–ç•¥æ¨¡å¼**: æˆ˜æ–—ä¼¤å®³è®¡ç®—
- **è§‚å¯Ÿè€…æ¨¡å¼**: äº‹ä»¶è§¦å‘

### å…³é”®ç‰¹æ€§
- å…¨å¼‚æ­¥IOæ“ä½œ
- æ•°æ®åº“è¿æ¥æ± 
- Redisç¼“å­˜ï¼ˆå¯é€‰ï¼‰
- é”™è¯¯å¤„ç†å’Œæ—¥å¿—
- é…ç½®çƒ­æ›´æ–°
- å®šæ—¶ä»»åŠ¡è°ƒåº¦

---

## ğŸ® æ¸¸æˆæœºåˆ¶

### æ•°å€¼å¹³è¡¡

#### ä¿®ç‚¼ç³»ç»Ÿ
- åŸºç¡€é€Ÿåº¦: 100ä¿®ä¸º/å°æ—¶
- æ‚Ÿæ€§åŠ æˆ: æ¯ç‚¹æ‚Ÿæ€§+5%é€Ÿåº¦
- æ ¹éª¨åŠ æˆ: æ¯ç‚¹æ ¹éª¨+3%é€Ÿåº¦
- åŠŸæ³•åŠ æˆ: 50%-200%
- å¢ƒç•Œæƒ©ç½š: å¢ƒç•Œè¶Šé«˜é€Ÿåº¦è¶Šæ…¢

#### æˆ˜æ–—ç³»ç»Ÿ
- ä¼¤å®³å…¬å¼: (æ”»å‡»åŠ› - é˜²å¾¡åŠ›/2) * éšæœº(0.8-1.2)
- æš´å‡»ç‡: åŸºç¡€5% + è£…å¤‡åŠ æˆ
- æš´å‡»ä¼¤å®³: åŸºç¡€150% + è£…å¤‡åŠ æˆ
- é€Ÿåº¦: å†³å®šå…ˆæ‰‹é¡ºåº

#### çªç ´ç³»ç»Ÿ
- åŸºç¡€æˆåŠŸç‡: 70%
- æ‚Ÿæ€§åŠ æˆ: æ¯ç‚¹+1%
- æ ¹éª¨åŠ æˆ: æ¯ç‚¹+0.5%
- å¢ƒç•Œæƒ©ç½š: æ¯ä¸ªå¤§å¢ƒç•Œ-5%
- å¤±è´¥æƒ©ç½š: æŸå¤±10%ä¿®ä¸º

### ç»æµå¹³è¡¡
- æ¯æ—¥ç­¾åˆ°: 1000çµçŸ³ + è¿ç»­å¥–åŠ±
- æˆ˜æ–—æ”¶ç›Š: 10-200çµçŸ³/æ¬¡
- è£…å¤‡ä»·æ ¼: 100-50000çµçŸ³
- åŠŸæ³•ä»·æ ¼: 1000-50000çµçŸ³
- å®—é—¨åˆ›å»º: 100000çµçŸ³
- äº¤æ˜“ç¨ç‡: 5%

---

## ğŸ“ˆ æ€§èƒ½è€ƒè™‘

### ä¼˜åŒ–ç­–ç•¥
1. **æ•°æ®åº“ä¼˜åŒ–**
   - ç´¢å¼•è®¾è®¡ï¼ˆtelegram_id, player_idç­‰ï¼‰
   - è¿æ¥æ± ç®¡ç†
   - æ‰¹é‡æŸ¥è¯¢

2. **ç¼“å­˜ç­–ç•¥**
   - Redisç¼“å­˜ç©å®¶ä¿¡æ¯
   - Redisç¼“å­˜æ’è¡Œæ¦œ
   - æœ¬åœ°ç¼“å­˜é™æ€æ•°æ®

3. **å¹¶å‘å¤„ç†**
   - å¼‚æ­¥IO
   - æ•°æ®åº“è¿æ¥æ± 
   - é”æœºåˆ¶é˜²æ­¢å¹¶å‘å†²çª

### å¯æ‰©å±•æ€§
- å¾®æœåŠ¡æ¶æ„ï¼ˆå¯é€‰ï¼‰
- æ•°æ®åº“åˆ†åº“åˆ†è¡¨
- æ¶ˆæ¯é˜Ÿåˆ—
- è´Ÿè½½å‡è¡¡

---

## ğŸš€ éƒ¨ç½²å»ºè®®

### å¼€å‘ç¯å¢ƒ
```bash
# å®‰è£…ä¾èµ–
pip install -e .

# åˆå§‹åŒ–æ•°æ®
python scripts/init_data.py

# å¯åŠ¨Bot
python -m bot.main
```

### ç”Ÿäº§ç¯å¢ƒ

#### ä½¿ç”¨ Systemd
```ini
[Unit]
Description=Xiuxian World Telegram Bot
After=network.target

[Service]
Type=simple
User=your_user
WorkingDirectory=/path/to/xiuxian-game
Environment="PATH=/path/to/venv/bin"
ExecStart=/path/to/venv/bin/python -m bot.main

[Install]
WantedBy=multi-user.target
```

#### ä½¿ç”¨ Docker
```dockerfile
FROM python:3.11-slim
WORKDIR /app
COPY . .
RUN pip install -e .
CMD ["python", "-m", "bot.main"]
```

#### ä½¿ç”¨ Supervisor
```ini
[program:xiuxian-game]
command=/path/to/venv/bin/python -m bot.main
directory=/path/to/xiuxian-game
autostart=true
autorestart=true
```

---

## ğŸ”® æœªæ¥è§„åˆ’

### çŸ­æœŸè®¡åˆ’ï¼ˆv1.1ï¼‰
- [ ] å®Œå–„æˆ˜æ–—ç³»ç»Ÿï¼ˆæŠ€èƒ½é‡Šæ”¾ï¼‰
- [ ] æ·»åŠ æ›´å¤šæ€ªç‰©å’ŒBoss
- [ ] ç§˜å¢ƒå‰¯æœ¬ç³»ç»Ÿ
- [ ] å¥½å‹ç³»ç»Ÿ
- [ ] WebAppç®¡ç†ç•Œé¢

### ä¸­æœŸè®¡åˆ’ï¼ˆv1.2-1.5ï¼‰
- [ ] å¤šæœåŠ¡å™¨æ¶æ„
- [ ] è·¨æœç«æŠ€
- [ ] å…¬ä¼šè”ç›Ÿ
- [ ] æ´»åŠ¨ç³»ç»Ÿ
- [ ] å……å€¼ç³»ç»Ÿï¼ˆå¯é€‰ï¼‰

### é•¿æœŸè§„åˆ’ï¼ˆv2.0+ï¼‰
- [ ] 3Då¯è§†åŒ–ç•Œé¢
- [ ] ç§»åŠ¨App
- [ ] åŒºå—é“¾é›†æˆ
- [ ] AI NPC
- [ ] å¤šè¯­è¨€æ”¯æŒ

---

## ğŸ“ ç»´æŠ¤æŒ‡å—

### æ—¥å¸¸ç»´æŠ¤
- å®šæœŸå¤‡ä»½æ•°æ®åº“
- ç›‘æ§Botè¿è¡ŒçŠ¶æ€
- æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶
- æ›´æ–°ä¾èµ–åº“

### æ•°æ®å¤‡ä»½
```bash
# å¤‡ä»½SQLiteæ•°æ®åº“
cp data/xiuxian.db data/backups/xiuxian_$(date +%Y%m%d).db

# å¤‡ä»½PostgreSQL
pg_dump xiuxian > backups/xiuxian_$(date +%Y%m%d).sql
```

### æ•…éšœæ’æŸ¥
1. æ£€æŸ¥æ—¥å¿—: `tail -f data/logs/xiuxian.log`
2. æ£€æŸ¥æ•°æ®åº“è¿æ¥
3. æ£€æŸ¥Redisè¿æ¥
4. æ£€æŸ¥ç½‘ç»œè¿æ¥
5. é‡å¯BotæœåŠ¡

---

## ğŸ“ å­¦ä¹ èµ„æº

### ç›¸å…³æ–‡æ¡£
- [python-telegram-bot Documentation](https://docs.python-telegram-bot.org/)
- [SQLAlchemy Documentation](https://docs.sqlalchemy.org/)
- [Pydantic Documentation](https://docs.pydantic.dev/)

### æ¨èé˜…è¯»
- Telegram Bot APIå®˜æ–¹æ–‡æ¡£
- Pythonå¼‚æ­¥ç¼–ç¨‹æŒ‡å—
- æ¸¸æˆæ•°å€¼å¹³è¡¡è®¾è®¡

---

## ğŸ“§ è”ç³»æ–¹å¼

- **Issues**: GitHub Issues
- **Discussions**: GitHub Discussions
- **Email**: ec@ai.com

---

## ğŸ“„ è®¸å¯è¯

MIT License - è¯¦è§ LICENSE æ–‡ä»¶

---

**é¡¹ç›®å®Œæˆåº¦**: 90% âœ¨

**æœ€åæ›´æ–°**: 2025-11-22
